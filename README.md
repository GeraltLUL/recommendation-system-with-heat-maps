# Платформа Игровой Аналитики с Тепловыми Картами

Проект представляет собой клиент-серверную систему для сбора, хранения и анализа данных из игрового приложения (Unity), с фокусом на визуализацию данных с помощью тепловых карт и аналитику поведения игроков.

## Основные Возможности

*   **Сбор данных из игры:** Клиент Unity отправляет события (перемещение, прыжки, взаимодействия и др.) на сервер.
*   **Хранение данных:** Серверная часть на Flask сохраняет полученные события в реляционной базе данных (используя SQLAlchemy).
*   **Аутентификация и Авторизация:** Система управления пользователями с ролями (Администратор, Аналитик) на базе Flask-Login.
*   **API для событий:** RESTful API эндпоинт для приема данных от клиента.
*   **Визуализация данных:**
    *   Генерация данных для построения тепловых карт (heatmap) плотности событий на игровых уровнях.
*   **Веб-интерфейс:** Базовый интерфейс для просмотра данных и управления (доступен для ролей Аналитик и Администратор).
*   **Управление через CLI:** Команды Flask CLI для инициализации ролей и создания пользователя-администратора.

## Технологический Стек

*   **Бэкенд:** Python 3, Flask, Flask-SQLAlchemy, Flask-Login, Flask-Migrate
*   **База данных:** Реляционная СУБД (например, PostgreSQL, SQLite - настраивается)
*   **Клиент (Пример):** Unity (C#)
*   **Фронтенд (Визуализация):** JavaScript (например, heatmap.js)

## Установка и Настройка

1.  **Клонировать репозиторий:**
    ```bash
    git clone https://github.com/GeraltLUL/recommendation-system-with-heat-maps.git
    cd recommendation-system-with-heat-maps
    ```

2.  **Создать и активировать виртуальное окружение:**
    ```bash
    # Windows
    python -m venv venv
    venv\Scripts\activate

    # macOS/Linux
    python3 -m venv venv
    source venv/bin/activate
    ```

3.  **Установить зависимости:**
    ```bash
    pip install -r requirements.txt
    ```

4.  **Настроить переменные окружения:**
    *   Скопируйте `.env.example` в `.env`.
    *   Отредактируйте `.env`:
        *   Установите надежный `SECRET_KEY`.
        *   При необходимости измените `DATABASE_URL` для подключения к вашей СУБД (по умолчанию используется SQLite в папке `instance`).

5.  **Инициализировать базу данных:**
    *   Если вы используете базу данных впервые:
        ```bash
        flask db init # Только один раз для проекта
        flask db migrate -m "Initial database schema"
        flask db upgrade
        ```
    *   Если миграции уже существуют (как в этом репозитории), достаточно:
        ```bash
        flask db upgrade
        ```

6.  **Создать роли и администратора:**
    ```bash
    flask create-roles
    flask create-admin
    ```
    *   Учетные данные администратора по умолчанию:
        *   Логин: `adminLogin`
        *   Пароль: `adminPassword`

## Запуск Приложения

1.  **Запустить Flask development server:**
    ```bash
    flask run
    ```
    Или (если используется `run.py` напрямую):
    ```bash
    python run.py
    ```

2.  **Открыть веб-интерфейс:**
    Перейдите в браузере по адресу: `http://127.0.0.1:5000` (или `http://localhost:5000`)

3.  **Войти:** Используйте учетные данные администратора или другие, созданные администратором.

## API Приема Событий

*   **Эндпоинт:** `POST /api/events` (Точный URL может быть настроен в `app/api.py` или аналогичном файле)
*   **Формат данных:** JSON, соответствующий структуре `EventBatch` из клиента Unity (`MovementTracker.cs`).

## Настройка Клиента Unity (Пример)

*   В компоненте `DataSender` на игровом объекте в Unity установите поле `serverUrl` в значение, соответствующее адресу вашего запущенного сервера и API эндпоинта (например, `http://<IP-адрес-сервера>:5000/api/events`).
